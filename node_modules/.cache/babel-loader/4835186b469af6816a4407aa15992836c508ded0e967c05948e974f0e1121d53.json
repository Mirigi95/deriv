{"ast":null,"code":"import{useEffect,useState}from'react';const useDerivWebSocket=(apiToken,symbol)=>{const[tick,setTick]=useState(null);const[error,setError]=useState(null);const[ws,setWs]=useState(null);useEffect(()=>{const socket=new WebSocket('wss://ws.binaryws.com/websockets/v3?app_id=1089');socket.onopen=()=>{socket.send(JSON.stringify({authorize:apiToken}));};socket.onmessage=event=>{const response=JSON.parse(event.data);if(response.error){setError(response.error.message);}if(response.msg_type==='authorize'){socket.send(JSON.stringify({ticks:symbol,subscribe:1}));}if(response.msg_type==='tick'){setTick(response.tick);}};socket.onerror=event=>{setError(event.message);};socket.onclose=()=>{console.log('WebSocket closed');};setWs(socket);return()=>{socket.close();};},[apiToken,symbol]);return{tick,error,ws};};export default useDerivWebSocket;","map":{"version":3,"names":["useEffect","useState","useDerivWebSocket","apiToken","symbol","tick","setTick","error","setError","ws","setWs","socket","WebSocket","onopen","send","JSON","stringify","authorize","onmessage","event","response","parse","data","message","msg_type","ticks","subscribe","onerror","onclose","console","log","close"],"sources":["/home/mtume/Gava/bima/src/Websocket.js"],"sourcesContent":["import { useEffect, useState } from 'react';\n\nconst useDerivWebSocket = (apiToken, symbol) => {\n  const [tick, setTick] = useState(null);\n  const [error, setError] = useState(null);\n  const [ws, setWs] = useState(null);\n\n  useEffect(() => {\n    const socket = new WebSocket('wss://ws.binaryws.com/websockets/v3?app_id=1089');\n\n    socket.onopen = () => {\n      socket.send(JSON.stringify({ authorize: apiToken }));\n    };\n\n    socket.onmessage = (event) => {\n      const response = JSON.parse(event.data);\n\n      if (response.error) {\n        setError(response.error.message);\n      }\n\n      if (response.msg_type === 'authorize') {\n        socket.send(JSON.stringify({ ticks: symbol, subscribe: 1 }));\n      }\n\n      if (response.msg_type === 'tick') {\n        setTick(response.tick);\n      }\n    };\n\n    socket.onerror = (event) => {\n      setError(event.message);\n    };\n\n    socket.onclose = () => {\n      console.log('WebSocket closed');\n    };\n\n    setWs(socket);\n\n    return () => {\n      socket.close();\n    };\n  }, [apiToken, symbol]);\n\n  return { tick, error, ws };\n};\n\nexport default useDerivWebSocket;\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAE3C,KAAM,CAAAC,iBAAiB,CAAGA,CAACC,QAAQ,CAAEC,MAAM,GAAK,CAC9C,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGL,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACM,KAAK,CAAEC,QAAQ,CAAC,CAAGP,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAACQ,EAAE,CAAEC,KAAK,CAAC,CAAGT,QAAQ,CAAC,IAAI,CAAC,CAElCD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAW,MAAM,CAAG,GAAI,CAAAC,SAAS,CAAC,iDAAiD,CAAC,CAE/ED,MAAM,CAACE,MAAM,CAAG,IAAM,CACpBF,MAAM,CAACG,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC,CAAEC,SAAS,CAAEd,QAAS,CAAC,CAAC,CAAC,CACtD,CAAC,CAEDQ,MAAM,CAACO,SAAS,CAAIC,KAAK,EAAK,CAC5B,KAAM,CAAAC,QAAQ,CAAGL,IAAI,CAACM,KAAK,CAACF,KAAK,CAACG,IAAI,CAAC,CAEvC,GAAIF,QAAQ,CAACb,KAAK,CAAE,CAClBC,QAAQ,CAACY,QAAQ,CAACb,KAAK,CAACgB,OAAO,CAAC,CAClC,CAEA,GAAIH,QAAQ,CAACI,QAAQ,GAAK,WAAW,CAAE,CACrCb,MAAM,CAACG,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC,CAAES,KAAK,CAAErB,MAAM,CAAEsB,SAAS,CAAE,CAAE,CAAC,CAAC,CAAC,CAC9D,CAEA,GAAIN,QAAQ,CAACI,QAAQ,GAAK,MAAM,CAAE,CAChClB,OAAO,CAACc,QAAQ,CAACf,IAAI,CAAC,CACxB,CACF,CAAC,CAEDM,MAAM,CAACgB,OAAO,CAAIR,KAAK,EAAK,CAC1BX,QAAQ,CAACW,KAAK,CAACI,OAAO,CAAC,CACzB,CAAC,CAEDZ,MAAM,CAACiB,OAAO,CAAG,IAAM,CACrBC,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC,CACjC,CAAC,CAEDpB,KAAK,CAACC,MAAM,CAAC,CAEb,MAAO,IAAM,CACXA,MAAM,CAACoB,KAAK,CAAC,CAAC,CAChB,CAAC,CACH,CAAC,CAAE,CAAC5B,QAAQ,CAAEC,MAAM,CAAC,CAAC,CAEtB,MAAO,CAAEC,IAAI,CAAEE,KAAK,CAAEE,EAAG,CAAC,CAC5B,CAAC,CAED,cAAe,CAAAP,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}