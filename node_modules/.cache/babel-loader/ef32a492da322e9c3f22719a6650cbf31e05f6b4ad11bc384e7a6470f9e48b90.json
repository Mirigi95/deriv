{"ast":null,"code":"var _jsxFileName = \"/home/mtume/Gava/bima/src/Trade.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useCallback } from 'react';\nimport './App.css';\nimport useDerivWebSocket from './websocket';\n\n// Replace with your Deriv API token\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst apiToken = 'YOUR_DERIV_API_TOKEN';\nconst symbol = 'R_100';\nfunction Trade() {\n  _s();\n  const {\n    tick,\n    error,\n    ws\n  } = useDerivWebSocket(apiToken, symbol);\n  const [lastTick, setLastTick] = useState(null);\n  const [lastOrderTime, setLastOrderTime] = useState(0);\n  const [tickHistory, setTickHistory] = useState([]);\n  const [position, setPosition] = useState(null);\n  const throttleTime = 5000; // 5 seconds for throttling\n  const shortPeriod = 12;\n  const longPeriod = 26;\n  const signalPeriod = 9;\n  const placeOrder = useCallback(contractType => {\n    if (!ws) return;\n    const order = {\n      buy: 1,\n      price: 10,\n      // Amount you want to trade\n      parameters: {\n        amount: 10,\n        // Stake amount\n        basis: 'stake',\n        // Basis\n        contract_type: contractType,\n        // Contract type ('CALL' or 'PUT')\n        currency: 'USD',\n        // Currency\n        duration: 1,\n        // Duration\n        duration_unit: 'm',\n        // Duration unit\n        symbol: symbol // Symbol\n      }\n    };\n    ws.send(JSON.stringify(order));\n  }, [ws]);\n  const calculateEMA = (data, period) => {\n    const k = 2 / (period + 1);\n    return data.reduce((acc, current, index) => {\n      if (index === 0) return current.quote;\n      return current.quote * k + acc * (1 - k);\n    }, data[0].quote);\n  };\n  const calculateMACD = data => {\n    const shortEMA = calculateEMA(data.slice(-shortPeriod), shortPeriod);\n    const longEMA = calculateEMA(data.slice(-longPeriod), longPeriod);\n    return shortEMA - longEMA;\n  };\n  const calculateSignalLine = macdHistory => {\n    return calculateEMA(macdHistory, signalPeriod);\n  };\n  useEffect(() => {\n    const now = Date.now();\n    if (tick && lastTick && now - lastOrderTime > throttleTime) {\n      setTickHistory(prevHistory => [...prevHistory, tick].slice(-longPeriod));\n      if (tickHistory.length >= longPeriod) {\n        const macd = calculateMACD(tickHistory);\n        const macdHistory = tickHistory.map((t, index) => {\n          const slice = tickHistory.slice(index + 1 - shortPeriod, index + 1);\n          return calculateMACD(slice);\n        }).slice(-signalPeriod);\n        const signalLine = calculateSignalLine(macdHistory);\n        if (macd > signalLine && !position) {\n          console.log('Bullish signal detected, buying...');\n          placeOrder('CALL');\n          setPosition('CALL');\n        } else if (macd < signalLine && position) {\n          console.log('Bearish signal detected, selling...');\n          placeOrder('PUT');\n          setPosition(null);\n        }\n      }\n      setLastOrderTime(now);\n    }\n    setLastTick(tick);\n  }, [tick, lastTick, placeOrder, lastOrderTime, tickHistory, position]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"App-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Deriv Trading Bot\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'red'\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 19\n      }, this), tick && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Symbol: \", tick.symbol]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Quote: \", tick.quote]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n}\n_s(Trade, \"v2QKdrFGqaPhE1Nogo7ptpjrnas=\", false, function () {\n  return [useDerivWebSocket];\n});\n_c = Trade;\nexport default Trade;\nvar _c;\n$RefreshReg$(_c, \"Trade\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","useDerivWebSocket","jsxDEV","_jsxDEV","apiToken","symbol","Trade","_s","tick","error","ws","lastTick","setLastTick","lastOrderTime","setLastOrderTime","tickHistory","setTickHistory","position","setPosition","throttleTime","shortPeriod","longPeriod","signalPeriod","placeOrder","contractType","order","buy","price","parameters","amount","basis","contract_type","currency","duration","duration_unit","send","JSON","stringify","calculateEMA","data","period","k","reduce","acc","current","index","quote","calculateMACD","shortEMA","slice","longEMA","calculateSignalLine","macdHistory","now","Date","prevHistory","length","macd","map","t","signalLine","console","log","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","color","_c","$RefreshReg$"],"sources":["/home/mtume/Gava/bima/src/Trade.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\nimport './App.css';\nimport useDerivWebSocket from './websocket';\n\n// Replace with your Deriv API token\nconst apiToken = 'YOUR_DERIV_API_TOKEN';\nconst symbol = 'R_100';\n\nfunction Trade() {\n  const { tick, error, ws } = useDerivWebSocket(apiToken, symbol);\n  const [lastTick, setLastTick] = useState(null);\n  const [lastOrderTime, setLastOrderTime] = useState(0);\n  const [tickHistory, setTickHistory] = useState([]);\n  const [position, setPosition] = useState(null);\n\n  const throttleTime = 5000; // 5 seconds for throttling\n  const shortPeriod = 12;\n  const longPeriod = 26;\n  const signalPeriod = 9;\n\n  const placeOrder = useCallback((contractType) => {\n    if (!ws) return;\n\n    const order = {\n      buy: 1,\n      price: 10, // Amount you want to trade\n      parameters: {\n        amount: 10, // Stake amount\n        basis: 'stake', // Basis\n        contract_type: contractType, // Contract type ('CALL' or 'PUT')\n        currency: 'USD', // Currency\n        duration: 1, // Duration\n        duration_unit: 'm', // Duration unit\n        symbol: symbol, // Symbol\n      },\n    };\n\n    ws.send(JSON.stringify(order));\n  }, [ws]);\n\n  const calculateEMA = (data, period) => {\n    const k = 2 / (period + 1);\n    return data.reduce((acc, current, index) => {\n      if (index === 0) return current.quote;\n      return current.quote * k + acc * (1 - k);\n    }, data[0].quote);\n  };\n\n  const calculateMACD = (data) => {\n    const shortEMA = calculateEMA(data.slice(-shortPeriod), shortPeriod);\n    const longEMA = calculateEMA(data.slice(-longPeriod), longPeriod);\n    return shortEMA - longEMA;\n  };\n\n  const calculateSignalLine = (macdHistory) => {\n    return calculateEMA(macdHistory, signalPeriod);\n  };\n\n  useEffect(() => {\n    const now = Date.now();\n    if (tick && lastTick && now - lastOrderTime > throttleTime) {\n      setTickHistory((prevHistory) => [...prevHistory, tick].slice(-longPeriod));\n\n      if (tickHistory.length >= longPeriod) {\n        const macd = calculateMACD(tickHistory);\n        const macdHistory = tickHistory.map((t, index) => {\n          const slice = tickHistory.slice(index + 1 - shortPeriod, index + 1);\n          return calculateMACD(slice);\n        }).slice(-signalPeriod);\n\n        const signalLine = calculateSignalLine(macdHistory);\n\n        if (macd > signalLine && !position) {\n          console.log('Bullish signal detected, buying...');\n          placeOrder('CALL');\n          setPosition('CALL');\n        } else if (macd < signalLine && position) {\n          console.log('Bearish signal detected, selling...');\n          placeOrder('PUT');\n          setPosition(null);\n        }\n      }\n      setLastOrderTime(now);\n    }\n    setLastTick(tick);\n  }, [tick, lastTick, placeOrder, lastOrderTime, tickHistory, position]);\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <h1>Deriv Trading Bot</h1>\n        {error && <p style={{ color: 'red' }}>{error}</p>}\n        {tick && (\n          <div>\n            <p>Symbol: {tick.symbol}</p>\n            <p>Quote: {tick.quote}</p>\n          </div>\n        )}\n      </header>\n    </div>\n  );\n}\n\nexport default Trade;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}